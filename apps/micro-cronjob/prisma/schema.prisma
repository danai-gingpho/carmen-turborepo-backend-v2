generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["postgresqlExtensions", "relationJoins"]
}

generator prismaTypesGenerator {
  provider    = "prisma-types-generator"
  modelSuffix = "Model"
  prettier    = "true"
}

generator json {
  provider = "prisma-json-types-generator"
}

datasource db {
  provider = "postgresql"
  url      = env("CRONJOB_DB_URL")
}

model User {
  id               String         @id @default(cuid())
  email            String         @unique
  name             String?
  password         String
  role             String         @default("user") // "admin" or "user"
  socketId         String?
  isOnline         Boolean        @default(false)
  createdCronJobs  CronJob[]      @relation("CronJobCreator")
  createdAt        DateTime       @default(now())
}

model CronJob {
  id          String    @id @default(cuid())
  name        String    @unique
  description String?
  cronExpression String  // e.g., "0 9 * * *" for daily at 9AM
  isActive    Boolean   @default(true)
  jobType     String    // 'notification_check', 'daily_summary', 'custom'
  jobData     String?   // JSON string for job parameters
  createdBy   String?   // admin user who created this job
  creator     User?     @relation("CronJobCreator", fields: [createdBy], references: [id])
  lastRun     DateTime?
  nextRun     DateTime?
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
}
